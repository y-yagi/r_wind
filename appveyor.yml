# This file was generated on 2019-01-03T20:34:23+00:00 from the rspec-dev repo.
# DO NOT modify it by hand as your changes will get lost the next time it is generated.

version: "{build}"

# This will build all PRs targetting matching branches.
# Without this, each PR builds twice -- once for the PR branch HEAD,
# and once for the merge commit that github creates for each mergable PR.
branches:
  only:
    - master
    - /.*-maintenance$/

# Disable normal Windows builds in favor of our test script.
build: off

cache:
  - vendor/bundle

install:
  - curl -fsS --retry 3 --retry-connrefused -o sqlite3.zip https://sqlite.org/2017/sqlite-dll-win64-x64-3160200.zip
  - 7z e sqlite3.zip -y
  - set SQLITE3_LIB_DIR=%APPVEYOR_BUILD_FOLDER%
  - '"C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\bin\lib.exe" /def:sqlite3.def /OUT:sqlite3.lib /machine:x64'
  - set PATH=C:\Ruby%RUBY_VERSION%\bin;%PATH%
  - bundle config --local path vendor/bundle
  - bundle install

before_test:
  - ruby --version
  - gem --version
  - bundle --version

test_script:
  -  bundle exec rails test

environment:
  matrix:
    - ruby_version: 26-x64
